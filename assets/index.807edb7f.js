import{_ as e,u as s,s as t,d as a,a as o,c as i,P as r}from"./index.a9b22ec9.js";import{x as n,y as d,z as l,C as c,p,N as u,j as h,O as m}from"./vue.00223571.js";const w=[{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address[]",name:"_addrArr",type:"address[]"},{internalType:"bool",name:"_flag",type:"bool"}],name:"setFeeAddressMap",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"feeAddressMap",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"}],y={data:()=>({type:1,addressList:"",isLoading:!1,isShowOwner:!1}),computed:{currAddress:()=>s().address,web3:()=>s().web3},components:{},async created(){await this.initData()},methods:{async subBtn(){let e=this;if(!this.currAddress||!this.web3)return;let s=this.addressList;if(!s)return t("请输入符合evm的地址列表");const o=s.match(/^[^\r\n]+/gm).filter((e=>""!==e.trim()));let i=[];for(let t=0;t<o.length;t++){const s=o[t];try{let t=e.web3.utils.toChecksumAddress(s.trim());i.push(t)}catch(r){continue}}if(i.length<=0)return t("没有符合evm的地址列表");console.log(i);try{e.isLoading=!0;let s=new e.web3.eth.Contract(w,a.projectContract),o=await e.web3.eth.getGasPrice();parseFloat(o)<=3e9&&(o="3000000000");let r=await s.methods.setFeeAddressMap(i,1==e.type).estimateGas({from:e.currAddress});await s.methods.setFeeAddressMap(i,1==e.type).send({from:e.currAddress,gas:e.web3.utils.toBN(r).add(e.web3.utils.toBN(parseInt(.2*r))),gasPrice:e.web3.utils.toBN(o)}).on("transactionHash",(e=>{console.log("transactionHash",e)})).on("receipt",(s=>{console.log("receipt",s),t("操作成功"),setTimeout((()=>{e.isLoading=!1}),1500)})).on("error",(s=>{console.log("error",s),(null==s?void 0:s.message)?t(null==s?void 0:s.message):t(JSON.stringify(s)),setTimeout((()=>{e.isLoading=!1}),1500),e.isLoading=!1}))}catch(r){console.log("error",r),(null==r?void 0:r.message)?t(null==r?void 0:r.message):t(JSON.stringify(r)),setTimeout((()=>{e.isLoading=!1}),1500)}},async initData(){let e=this;if(!this.currAddress||!this.web3)return void(this.isShowOwner=!1);let s=new e.web3.eth.Contract(w,a.projectContract);try{(await s.methods.owner().call({from:e.currAddress})).toLocaleUpperCase()!=e.currAddress.toLocaleUpperCase()?this.isShowOwner=!0:this.isShowOwner=!1}catch(t){return}},changeType(e){this.type=e}},watch:{isLoading(){this.isLoading?o({duration:0,forbidClick:!0,message:""}):i()},async currAddress(){await this.initData()}}},g={class:"home_page"},b={class:"bar_tools"},f=l("div",{class:"from_title"},"地址列表，多个地址请用换行分割！",-1),v={class:"from_input"},_=l("div",{class:"pop_content"},[l("div",{class:"pop_title"},"警告"),l("div",{class:"address_short"}," 请用owner用户操作 ")],-1);const A=e(y,[["render",function(e,s,t,a,o,i){const w=r;return n(),d("div",g,[l("div",b,[l("div",{class:c(["tools_item",{tools_item_act:1==o.type}]),onClick:s[0]||(s[0]=e=>i.changeType(1))},"设置黑名单",2),l("div",{class:c(["tools_item",{tools_item_act:2==o.type}]),onClick:s[1]||(s[1]=e=>i.changeType(2))},"解除黑名单",2)]),f,l("div",v,[p(l("textarea",{"onUpdate:modelValue":s[2]||(s[2]=e=>o.addressList=e)},null,512),[[u,o.addressList]])]),l("div",{class:"sub_btn",onClick:s[3]||(s[3]=e=>i.subBtn())},"提交"),h(w,{class:"pop_Recharge",show:o.isShowOwner,"onUpdate:show":s[4]||(s[4]=e=>o.isShowOwner=e),style:{width:"5.7rem"},"close-on-click-overlay":!1},{default:m((()=>[_])),_:1},8,["show"])])}]]);export{A as default};